var StarRtc=window.NameSpace||{};if(void 0===APP_PRODUCT_ID)var i=0,APP_PRODUCT_ID={R:i++,O:i++,t:i++,_:i++,s:i++,S:i++,i:i++,I:i++,o:i++,A:i++,N:i++};if(void 0===ACTION_GROUP_ID){i=0;var ACTION_GROUP_ID={M:i++,V:i++,C:i++,u:i++,T:i++,P:i++}}if(void 0===MSG_TYPE){i=0;var MSG_TYPE={L:i++,G:i++,l:i++,D:i++,p:i++}}if(void 0===MSG_DATA_TYPE){i=0;var MSG_DATA_TYPE={U:i++,v:i++,H:i++,k:i++}}if(void 0===ENCRYPT_TYPE){i=0;var ENCRYPT_TYPE={m:i++,g:i++}}if(void 0===AG_MSG_VOIP_CTRL)var AG_MSG_VOIP_CTRL={h:1e3,Y:1100,F:1001,K:1002,W:1003,B:1004};if(void 0===CHATROOM_LIST_TYPE){i=0;var CHATROOM_LIST_TYPE={CHATROOM_LIST_TYPE_CHATROOM:i++,CHATROOM_LIST_TYPE_LIVE:i++,CHATROOM_LIST_TYPE_LIVE_PUSH:i++,CHATROOM_LIST_TYPE_MEETING:i++,CHATROOM_LIST_TYPE_MEETING_PUSH:i++,CHATROOM_LIST_TYPE_CLASS:i++,CHATROOM_LIST_TYPE_CLASS_PUSH:i++,CHATROOM_LIST_TYPE_AUDIO_LIVE:i++,CHATROOM_LIST_TYPE_AUDIO_LIVE_PUSH:i++,CHATROOM_LIST_TYPE_SUPER_ROOM:i++,CHATROOM_LIST_TYPE_SUPER_ROOM_PUSH:i++}}if(StarRtc.CHATROOM_LIST_TYPE=CHATROOM_LIST_TYPE,void 0===AG_MSG){i=0;var AG_MSG={q:i++,J:i++,j:i++,X:i++,Z:i++,$:i++,ee:i++,Re:i++,Oe:i++,te:i++,ae:i++,_e:i++,Ee:i++,ne:i++,se:i++,re:i++,ce:i++,Se:i++,ie:i++,Ie:i++,oe:i++,Ae:i++,Ne:i++,Me:i++,Ve:i++,Ce:i++,ue:i++,Te:i++,Pe:i++,Le:i++,Ge:i++,le:i++,fe:i++,De:i++,pe:i++,Ue:i++,de:i++,ve:i++,be:i++,He:i++,ke:i++,me:i++,ge:i++,we:i++,ye:i++}}if(void 0===CHAT_ROOM_TYPE){i=1;var CHAT_ROOM_TYPE={he:i++,xe:i++}}if(void 0===AG_CHATROOMMOONSERVER){i=0;var AG_CHATROOMMOONSERVER={Ye:i++,Fe:i++,Ke:i++,We:i++,Be:i++,qe:i++,Je:i++,Qe:i++,je:i++,Xe:i++,ze:i++,Ze:i++,$e:i++,eR:i++,RR:i++,OR:i++,tR:i++,aR:i++,_R:i++,ER:i++,nR:i++,sR:i++,rR:i++,cR:i++,SR:i++,iR:i++,IR:i++,oR:i++,AR:i++,NR:i++,MR:i++,VR:i++,CR:i++,uR:i++,TR:i++,PR:i++,LR:i++,GR:i++,lR:i++,fR:i++,DR:i++,pR:i++,UR:i++,dR:i++,vR:i++}}if(void 0===AG_VOIPMOONSERVER){i=0;var AG_VOIPMOONSERVER={bR:i++,HR:i++,kR:i++,mR:i++,gR:i++,wR:i++,yR:i++,hR:i++,xR:i++,YR:i++,FR:i++,KR:i++,WR:i++,BR:i++,qR:i++,JR:i++,QR:i++,jR:i++,XR:i++,zR:i++,ZR:i++,$R:i++,eO:i++,RO:i++,OO:i++,tO:i++,aO:i++,_O:i++,EO:i++,nO:i++,sO:i++,rO:i++,cO:i++,SO:i++,iO:i++,IO:i++,oO:i++,AO:i++,NO:i++}}if(void 0===AG_LIVESRCMOONSERVER){i=0;var AG_LIVESRCMOONSERVER={MO:i++,VO:i++,CO:i++,uO:i++,TO:i++,PO:i++,LO:i++,GO:i++,lO:i++,fO:i++,DO:i++,pO:i++,UO:i++,dO:i++,vO:i++,bO:i++,HO:i++,kO:i++,mO:i++,gO:i++,wO:i++,yO:i++,hO:i++,xO:i++,YO:i++,FO:i++,KO:i++,WO:i++,BO:i++,qO:i++,JO:i++,QO:i++,jO:i++,XO:i++,zO:i++,ZO:i++,$O:i++,et:i++,Rt:i++,Ot:i++,tt:i++,at:i++,_t:i++,Et:i++,nt:i++,st:i++,rt:i++,ct:i++,St:i++,it:i++,It:i++,ot:i++,At:i++,Nt:i++,Mt:i++,Vt:i++,Ct:i++,ut:i++,Tt:i++,Pt:i++,Lt:i++,Gt:i++,lt:i++,ft:i++,Dt:i++,pt:i++,Ut:i++,dt:i++,vt:i++,bt:i++,Ht:i++,kt:i++,gt:i++,wt:i++,yt:i++,ht:i++,xt:i++,Yt:i++,Ft:i++}}if(void 0===AG_LIVEVDNMOONSERVER){i=0;var AG_LIVEVDNMOONSERVER={Kt:i++,Wt:i++,Bt:i++,qt:i++,Jt:i++,Qt:i++,jt:i++,Xt:i++,zt:i++,Zt:i++,$t:i++,ea:i++,Ra:i++,Oa:i++,ta:i++,aa:i++,_a:i++,Ea:i++,na:i++,sa:i++,ra:i++,ca:i++,Sa:i++,ia:i++}}function clone(e){if(null==e||"object"!=typeof e)return e;if(e instanceof Date)return(R=new Date).setTime(e.getTime()),R;if(e instanceof Array){for(var R=[],O=e.length,t=0;t<O;++t)R[t]=clone(e[t]);return R}if(e instanceof Object){R={};for(var a in e)e.hasOwnProperty(a)&&(R[a]=clone(e[a]));return R}throw new Error("Unable to copy obj! Its type isn't supported.")}StarRtc.AUtils=new function(){var e=this;function L(e,R){for(var O=q(e),t=J(w(O.length.toString(16))),a=q(R),_=J(w(a.length.toString(16))),E=new Uint8Array(O.length+a.length+8),n=0,s=t.length,r=n;r<s;r++)E[r]=t[r-n];s=(n=s)+O.length;for(r=n;r<s;r++)E[r]=O[r-n];s=(n=s)+_.length;for(r=n;r<s;r++)E[r]=_[r-n];s=(n=s)+a.length;for(r=n;r<s;r++)E[r]=a[r-n];return E}function b(e){var R=new Uint8Array(e),O=0,t=parseInt("0x"+k(R.slice(O,O+4)));O+=4;var a=H(R.slice(O,O+t));O+=t;var _=parseInt("0x"+k(R.slice(O,O+4)));return O+=4,{digest:a,content:H(R.slice(O,O+_))}}function w(e){var R=8-e.length;return"00000000".substr(0,R)+e}function W(e){var R=4-e.length;return"0000".substr(0,R)+e}function B(e,R){var O=new Array(e+1).join("0"),t=e-R.length;return O.substr(0,t)+R}function q(e){var R,O,t=new Array;R=e.length;for(var a=0;a<R;a++)65536<=(O=e.charCodeAt(a))&&O<=1114111?(t.push(O>>18&7|240),t.push(O>>12&63|128),t.push(O>>6&63|128),t.push(63&O|128)):2048<=O&&O<=65535?(t.push(O>>12&15|224),t.push(O>>6&63|128),t.push(63&O|128)):128<=O&&O<=2047?(t.push(O>>6&31|192),t.push(63&O|128)):t.push(255&O);return t}function H(e){if("string"==typeof e)return e;for(var R="",O=e,t=0;t<O.length;t++){var a=O[t].toString(2),_=a.match(/^1+?(?=0)/);if(_&&8==a.length){for(var E=_[0].length,n=O[t].toString(2).slice(7-E),s=1;s<E;s++)n+=O[s+t].toString(2).slice(2);R+=String.fromCharCode(parseInt(n,2)),t+=E-1}else R+=String.fromCharCode(O[t])}return R}function J(e){var R=0,O=e.length;if(O%2!=0)return null;O/=2;for(var t=new Array,a=0;a<O;a++){var _=e.substr(R,2),E=parseInt("0x"+_);t.push(E),R+=2}return t}function k(e){for(var R="",O=0;O<e.length;O++){var t=e[O].toString(16);1==t.length&&(t="0"+t),R+=t}return R}function Q(e,R,O){var t=R;for(var a in O)for(var _=O[a],E=0;E<_.length;E++,t++)e[t]=_[E]}e.parseProtocol=function(e,c){var R=new Blob([e],{type:"text/plain"}),S=new FileReader;S.readAsArrayBuffer(R),S.onload=function(e){var R=new Uint8Array(S.result);console.info("parseProtocol:",R);var O=R[0],t=R.slice(1,5),a=R[5],_=R.slice(6,8),E=R.slice(8,10),n=R[10],s=R.slice(11,R.byteLength-2);console.info("parseProtocol: msgArr = ",s);var r=R.slice(R.byteLength-2,R.byteLength);c({appid:O,plength:t,appver:a,rese1:_,rese2:E,actionid:n,msgArr:s,end:r})}},e.packageProtocol=function(e,R,O){var t=e,a=new Array(255,255),_=new Array(255,255),E=R,n=(new Array(18,52),O),s=new Uint8Array(n),r=J(w((n.byteLength+12).toString(16))),c=new ArrayBuffer(n.byteLength+13),S=new Uint8Array(c);S[0]=t;for(var i=1;i<5;i++)S[i]=r[i-1];S[5]=1,S[6]=a[0],S[7]=a[1],S[8]=_[0],S[9]=_[1],S[10]=E;for(i=11;i<11+s.byteLength;i++)S[i]=s[i-11];return S[11+s.byteLength]=18,S[12+s.byteLength]=52,console.log("packageProtocol",S),S},e.constructAuthMsg=function(e){e.agentId,e.userId;for(var R=e.starUid,O=e.starToken,t=J(W(AG_MSG.q.toString(16))),a=q(R),_=J(W(a.length.toString(16))),E=q(O),n=new Uint8Array(a.length+36),s=0,r=t.length,c=s;c<r;c++)n[c]=t[c];r=(s=r)+_.length;for(c=s;c<r;c++)n[c]=_[c-s];r=(s=r)+a.length;for(c=s;c<r;c++)n[c]=a[c-s];r=(s=r)+E.length;for(c=s;c<r;c++)n[c]=E[c-s];s=0;var S=[];return S.push(t),S.push(_),S.push(a),S.push(E),Q(n,s,S),n},e.constructMsgProtocol=function(e,R,O){O.agentId,O.userId;var t,a=O.starUid,_=O.starToken,E=[],n=J(W(e.toString(16))),s=q(a),r=J(W(s.length.toString(16)));J(W(q(_).length.toString(16)));switch(e){case AG_MSG.ee:var c=J(w(R.reqIndex.toString(16))),S=J(w((o=q(R.addUsers)).length.toString(16))),i=J(w((A=q(R.userDefineData)).length.toString(16)));t=new Uint8Array(6+(2+s.length)+(4+o.length)+(4+A.length)),E.push(n),E.push(c),E.push(r),E.push(s),E.push(S),E.push(o),E.push(i),E.push(A);break;case AG_MSG.Re:c=J(w(R.reqIndex.toString(16)));var I=J(W((V=q(O.agentId+"_"+R.groupId)).length.toString(16)));t=new Uint8Array(6+(2+V.length)+(2+s.length)),E.push(n),E.push(c),E.push(I),E.push(V),E.push(r),E.push(s);break;case AG_MSG.Oe:var o;c=J(w(R.reqIndex.toString(16))),I=J(W((V=q(O.agentId+"_"+R.groupId)).length.toString(16))),S=J(w((o=q(R.addUsers)).length.toString(16))),i=J(w((A=q(R.userDefineData)).length.toString(16)));t=new Uint8Array(6+(2+V.length)+(2+s.length)+(4+o.length)+(4+A.length)),E.push(n),E.push(c),E.push(I),E.push(V),E.push(r),E.push(s),E.push(S),E.push(o),E.push(i),E.push(A);break;case AG_MSG.te:c=J(w(R.reqIndex.toString(16))),I=J(W((V=q(O.agentId+"_"+R.groupId)).length.toString(16)));var A,N=q(R.removeUsers),M=J(w(N.length.toString(16)));i=J(w((A=q(R.userDefineData)).length.toString(16)));t=new Uint8Array(6+(2+V.length)+(2+s.length)+(4+N.length)),E.push(n),E.push(c),E.push(I),E.push(V),E.push(r),E.push(s),E.push(M),E.push(N);break;case AG_MSG.ae:case AG_MSG._e:c=J(w(R.reqIndex.toString(16))),I=J(W((V=q(O.agentId+"_"+R.groupId)).length.toString(16)));t=new Uint8Array(6+(2+V.length)+(2+s.length)),E.push(n),E.push(c),E.push(I),E.push(V),E.push(r),E.push(s);break;case AG_MSG.Ee:case AG_MSG.ne:break;case AG_MSG.de:c=J(w(R.reqIndex.toString(16)));t=new Uint8Array(6+(2+s.length)),E.push(n),E.push(c),E.push(r),E.push(s);break;case AG_MSG.be:var V;c=J(w(R.reqIndex.toString(16))),I=J(W((V=q(O.agentId+"_"+R.groupId)).length.toString(16)));t=new Uint8Array(6+(2+s.length)+(2+V.length)),E.push(n),E.push(c),E.push(r),E.push(s),E.push(I),E.push(V);break;case AG_MSG.ke:t=new Uint8Array(2),E.push(n);break;case AG_MSG.ge:t=new Uint8Array(4);var C=J(W(R.reqPageNum.toString(16)));E.push(n),E.push(C)}return Q(t,0,E),t},e.constructSingleMsg=function(e,R,O,t,a,_){var E=_.agentId,n=_.userId,s=_.starUid,r=(_.starToken,J(W(AG_MSG.$.toString(16)))),c=q(s),S=J(W(c.length.toString(16))),i=q(E+"_"+e),I=J(W(i.length.toString(16))),o=J(w(R.toString(16))),A=ENCRYPT_TYPE.m,N=MSG_DATA_TYPE.v;null!=a&&(N=a);var M={fromId:n,targetId:e,time:"0",msgIndex:R,type:1,code:0,contentData:t},V=L(O,JSON.stringify(M)),C=J(w(V.length.toString(16))),u=new Uint8Array(c.length+i.length+V.length+16),T=[];return T.push(r),T.push(S),T.push(c),T.push(I),T.push(i),T.push(o),T.push([A]),T.push([N]),T.push(C),T.push(V),Q(u,0,T),u},e.constructGroupMsg=function(e,R,O,t,a){var _=a.agentId,E=a.userId,n=a.starUid,s=(a.starToken,J(W(AG_MSG.se.toString(16)))),r=q(""),c=J(W(r.length.toString(16))),S=J(w(R.toString(16))),i=q(_+"_"+e),I=J(W(i.length.toString(16))),o=q(n),A=J(W(o.length.toString(16))),N=ENCRYPT_TYPE.m,M=MSG_DATA_TYPE.v,V={fromId:E,targetId:e,time:"0",msgIndex:R,type:1,code:0,contentData:t},C=L(O,JSON.stringify(V)),u=J(w(C.length.toString(16))),T=new Uint8Array(r.length+i.length+o.length+C.length+18),P=[];return P.push(s),P.push(c),P.push(r),P.push(S),P.push(I),P.push(i),P.push(A),P.push(o),P.push([N]),P.push([M]),P.push(u),P.push(C),Q(T,0,P),T},e.constructReceivedMsg=function(e,R){R.agentId,R.userId;var O=R.starUid,t=(R.starToken,J(W(AG_MSG.ue.toString(16)))),a=q(O),_=J(W(a.length.toString(16))),E=new Uint8Array(e),n=new Uint8Array(a.length+12),s=[];return s.push(t),s.push(_),s.push(a),s.push(E),Q(n,0,s),n},e.constructSingleCtrlMsg=function(e,R,O,t,a,_){var E=_.agentId,n=_.userId,s=_.starUid,r=(_.starToken,J(W(AG_MSG.$.toString(16)))),c=q(s),S=J(W(c.length.toString(16))),i=q(E+"_"+e),I=J(W(i.length.toString(16))),o=J(w(R.toString(16))),A=ENCRYPT_TYPE.m,N=MSG_DATA_TYPE.U,M={fromId:n,targetId:e,time:"0",msgIndex:R,type:0,code:parseInt(a),contentData:t},V=L(O,JSON.stringify(M)),C=J(w(V.length.toString(16))),u=new Uint8Array(c.length+i.length+V.length+16),T=[];return T.push(r),T.push(S),T.push(c),T.push(I),T.push(i),T.push(o),T.push([A]),T.push([N]),T.push(C),T.push(V),Q(u,0,T),u},e.constructVOIPProtocol=function(e,R,O){var t,a=O.agentId,_=(O.userId,O.starUid),E=O.starToken,n=[],s=J(W(e.toString(16))),r=q(_),c=J(W(r.length.toString(16))),S=q(E),i=J(W(S.length.toString(16)));switch(e){case AG_VOIPMOONSERVER.mR:case AG_VOIPMOONSERVER.wR:var I=q(a+"_"+R.targetId),o=J(W(I.length.toString(16))),A=J(B(8,parseInt(R.audioSSRC).toString(16))),N=J(B(8,parseInt(R.videoSSRC).toString(16))),M=J(B(2,parseInt(R.videoCodec).toString(16))),V=J(B(2,parseInt(R.audioCodec).toString(16)));t=new Uint8Array(2+(2+r.length)+(2+S.length)+(2+I.length)+4+4+1+1),n.push(s),n.push(c),n.push(r),n.push(i),n.push(S),n.push(o),n.push(I),n.push(A),n.push(N),n.push(M),n.push(V);break;case AG_VOIPMOONSERVER.xR:var C=R.isActive;t=new Uint8Array(3),n.push(s),n.push([C])}return Q(t,0,n),t},e.constructSrcProtocol=function(e,R,O){O.agentId;var t=O.userId,a=O.starUid,_=O.starToken,E=[],n=J(W(e.toString(16))),s=J(W((M=q(a)).length.toString(16))),r=J(W((v=q(_)).length.toString(16)));switch(e){case AG_LIVESRCMOONSERVER.Ft:case AG_LIVESRCMOONSERVER.kO:case AG_LIVESRCMOONSERVER.mO:var c=J(W(R.conCurrentNum.toString(16))),S=J(W((0).toString(16))),i=J(W((A=q(R.roomId)).length.toString(16))),I=R.liveType,o=J(W((u=q(R.extra)).length.toString(16)));Y=new Uint8Array(2+(2+M.length)+(2+v.length)+2+2+(2+A.length)+1+(2+u.length)),E.push(n),E.push(s),E.push(M),E.push(r),E.push(v),E.push(c),E.push(S),E.push(i),E.push(A),E.push([I]),E.push(o),E.push(u);break;case AG_LIVESRCMOONSERVER.gO:c=J(W(R.conCurrentNum.toString(16))),S=J(W(R.validTime.toString(16))),i=J(W((A=q(R.roomId)).length.toString(16))),o=J(W((u=q(R.extra)).length.toString(16)));var A,N=J(W((T=q(R.spec)).length.toString(16)));E.push(n),E.push(s),E.push(M),E.push(r),E.push(v),E.push(c),E.push(S),E.push(i),E.push(A),E.push(o),E.push(u),E.push(N),E.push(T);break;case AG_LIVESRCMOONSERVER.wO:s=J(W((M=q(t)).length.toString(16))),r=J(W((v=q(_)).length.toString(16))),S=J(W((0).toString(16)));var M,V=J(W((C=q(R.groupId)).length.toString(16)));o=J(W((u=q(R.extra)).length.toString(16)));E.push(n),E.push(s),E.push(M),E.push(r),E.push(v),E.push(S),E.push(V),E.push(C),E.push(o),E.push(u);break;case AG_LIVESRCMOONSERVER.yO:var C,u,T;S=J(W((0).toString(16))),V=J(W((C=q(R.groupId)).length.toString(16))),o=J(W((u=q(R.extra)).length.toString(16))),N=J(W((T=q(R.spec)).length.toString(16)));E.push(n),E.push(s),E.push(M),E.push(r),E.push(v),E.push(S),E.push(V),E.push(C),E.push(o),E.push(u),E.push(N),E.push(T);break;case AG_LIVESRCMOONSERVER.hO:var P=q(R.channelId),L=q(R.avParam),G=J(W(L.length.toString(16)));E.push(n),E.push(s),E.push(M),E.push(r),E.push(v),E.push(P),E.push(G),E.push(L);break;case AG_LIVESRCMOONSERVER.YO:P=q(R.channelId);var l=J(W((f=q(R.upUserId)).length.toString(16)));E.push(n),E.push(s),E.push(M),E.push(r),E.push(v),E.push(P),E.push(l),E.push(f);break;case AG_LIVESRCMOONSERVER.FO:case AG_LIVESRCMOONSERVER.KO:case AG_LIVESRCMOONSERVER.WO:var f;P=q(R.channelId),l=J(W((f=q(R.upUserId)).length.toString(16)));E.push(n),E.push(s),E.push(M),E.push(r),E.push(v),E.push(P),E.push(l),E.push(f);break;case AG_LIVESRCMOONSERVER.BO:case AG_LIVESRCMOONSERVER.qO:P=q(R.channelId);Y=new Uint8Array(2+(2+M.length)+(2+v.length)+16),E.push(n),E.push(s),E.push(M),E.push(r),E.push(v),E.push(P);break;case AG_LIVESRCMOONSERVER.JO:for(var D=R.streamConfig,p=new Uint8Array(16),U=0;U<16;U++)null!=D[U]?p[U]=D[U]:p[U]=0;Y=new Uint8Array(18),E.push(n),E.push(p);break;case AG_LIVESRCMOONSERVER.QO:P=q(R.channelId);E.push(n),E.push(P);break;case AG_LIVESRCMOONSERVER.XO:E.push(n);break;case AG_LIVESRCMOONSERVER.jO:var d=q(R.streamData);Y=new Uint8Array(3+d.length),E.push(n),E.push([R.streamDataType]),E.push(d);break;case AG_LIVESRCMOONSERVER.xO:var v,b=q(a),H=J(W(b.length.toString(16))),k=(r=J(W((v=q(_)).length.toString(16))),P=q(R.channelId),J(B(8,parseInt(R.audioSSRC).toString(16)))),m=J(B(8,parseInt(R.smallVideoSSRC).toString(16))),g=J(B(8,parseInt(R.bigVideoSSRC).toString(16))),w=J(B(2,parseInt(R.videoCodec).toString(16))),y=J(B(2,parseInt(R.audioCodec).toString(16))),h=J(W((F=q(R.iceUfrag)).length.toString(16))),x=J(W((K=q(R.icePwd)).length.toString(16))),Y=new Uint8Array(b.length+v.length+34+1+1+2+F.length+2+K.length);E.push(n),E.push(H),E.push(b),E.push(r),E.push(v),E.push(P),E.push(k),E.push(m),E.push(g),E.push(w),E.push(y),E.push(F),E.push(K);break;case AG_LIVESRCMOONSERVER.ht:var F,K;h=J(W((F=q(R.iceUfrag)).length.toString(16))),x=J(W((K=q(R.icePwd)).length.toString(16)));Y=new Uint8Array(4+F.length+2+K.length),E.push(n),E.push(h),E.push(F),E.push(x),E.push(K)}return Q(Y,0,E),Y},e.constructVdnProtocol=function(e,R,O){O.agentId,O.userId;var t,a=O.starUid,_=O.starToken,E=[],n=J(W(e.toString(16))),s=q(a),r=J(W(s.length.toString(16))),c=q(_),S=J(W(c.length.toString(16)));switch(e){case AG_LIVEVDNMOONSERVER.Bt:var i=q(R.iceUfrag),I=J(W(i.length.toString(16))),o=q(R.icePwd),A=J(W(o.length.toString(16)));t=new Uint8Array(4+i.length+2+o.length),E.push(n),E.push(I),E.push(i),E.push(A),E.push(o);break;case AG_LIVEVDNMOONSERVER.qt:var N=q(R.channelId);t=new Uint8Array(18+(2+s.length)+(2+c.length)),E.push(n),E.push(N),E.push(r),E.push(s),E.push(S),E.push(c);break;case AG_LIVEVDNMOONSERVER.Jt:case AG_LIVEVDNMOONSERVER.Qt:t=new Uint8Array(2),E.push(n);break;case AG_LIVEVDNMOONSERVER.zt:case AG_LIVEVDNMOONSERVER.jt:N=q(R.channelId);t=new Uint8Array(18),E.push(n),E.push(N);break;case AG_LIVEVDNMOONSERVER.Xt:for(var M=R.streamConfig,V=new Uint8Array(16),C=0;C<16;C++)null!=M[C]?V[C]=M[C]:V[C]=0;t=new Uint8Array(18),E.push(n),E.push(V)}return Q(t,0,E),t},e.constructChatProtocol=function(e,R,O){var t,a=O.agentId,_=O.userId,E=O.starUid,n=O.starToken,s=[],r=J(W(e.toString(16))),c=q(E),S=J(W(c.length.toString(16))),i=q(n),I=J(W(i.length.toString(16)));if(e==AG_CHATROOMMOONSERVER.Ye){var o=R.roomType,A=J(W(R.conCurrentNum.toString(16))),N=J(w((d=q(R.userDefineData)).length.toString(16)));t=new Uint8Array(2+(2+c.length)+(2+i.length)+1+2+(4+d.length)),s.push(r),s.push(S),s.push(c),s.push(I),s.push(i),s.push([o]),s.push(A),s.push(N),s.push(d)}else if(e==AG_CHATROOMMOONSERVER.Fe)t=new Uint8Array(2),s.push(r);else if(e==AG_CHATROOMMOONSERVER.Ke){var M=q(a+"_"+R.banUserId),V=J(W(M.length.toString(16))),C=J(W(R.banTime.toString(16)));t=new Uint8Array(2+(2+M.length)+2),s.push(r),s.push(V),s.push(M),s.push(C)}else if(e==AG_CHATROOMMOONSERVER.We){var u=q(a+"_"+R.kickOutUserId),T=J(W(u.length.toString(16)));t=new Uint8Array(2+(2+u.length)),s.push(r),s.push(T),s.push(u)}else if(e==AG_CHATROOMMOONSERVER.Be)t=new Uint8Array(2),s.push(r);else if(e==AG_CHATROOMMOONSERVER.qe){var P=q(R.roomId);t=new Uint8Array(2+(2+c.length)+(2+i.length)+16),s.push(r),s.push(S),s.push(c),s.push(I),s.push(i),s.push(P)}else if(e==AG_CHATROOMMOONSERVER.Je);else if(e==AG_CHATROOMMOONSERVER.Qe)t=new Uint8Array(2),s.push(r);else if(e==AG_CHATROOMMOONSERVER.je){var L={fromId:_,targetId:R.roomId,time:"0",msgIndex:R.msgIndex,type:1,code:0,contentData:R.msg},G=q(JSON.stringify(L)),l=J(w(G.length.toString(16)));t=new Uint8Array(2+(4+G.length)),s.push(r),s.push(l),s.push(G)}else if(e==AG_CHATROOMMOONSERVER.Xe){L={fromId:_,targetId:R.roomId,time:"0",msgIndex:R.msgIndex,type:parseInt(R.type),code:parseInt(R.code),contentData:R.msg};var f=q(JSON.stringify(L)),D=J(w(f.length.toString(16))),p=q(a+"_"+R.toUserId),U=J(W(p.length.toString(16)));t=new Uint8Array(2+(2+p.length)+(4+f.length)),s.push(r),s.push(U),s.push(p),s.push(D),s.push(f)}else if(e==AG_CHATROOMMOONSERVER.ze){P=q(R.roomId);t=new Uint8Array(18),s.push(r),s.push(P)}else if(e==AG_CHATROOMMOONSERVER.GR){var d,v=J(W((H=q(_)).length.toString(16))),b=J(W(R.listType.toString(16)));N=J(w((d=q(R.userDefineData)).length.toString(16))),P=q(R.roomId);t=new Uint8Array(4+(2+H.length)+16+(4+d.length)),s.push(r),s.push(b),s.push(v),s.push(H),s.push(P),s.push(N),s.push(d)}else if(e==AG_CHATROOMMOONSERVER.DR){b=J(W(R.listType.toString(16))),P=q(R.roomId),v=J(W((H=q(_)).length.toString(16)));t=new Uint8Array(4+(2+H.length)+16),s.push(r),s.push(b),s.push(v),s.push(H),s.push(P)}else if(e==AG_CHATROOMMOONSERVER.dR){var H,k=q(R.listTypes),m=J(W(k.length.toString(16))),g=J(W((H=q(R.userId)).length.toString(16)));t=new Uint8Array(2+(2+k.length)+(2+H.length)),s.push(r),s.push(m),s.push(k),s.push(g),s.push(H)}return Q(t,0,s),t},e.parseMessage=function(e,R){var O=new Uint8Array(e);switch(parseInt("0x"+k(O.slice(0,2)))){case AG_MSG.J:O=new Uint8Array(e);var t=parseInt("0x"+k(O.slice(2,4)));console.log("登录成功，最大消息长度：",t),R({status:"success",msgMaxLen:t},"onLoginMessage");break;case AG_MSG.j:console.log("登录失败"),R({status:"failed"},"onLoginMessage");break;case AG_MSG.Z:console.log("心跳反馈");break;case AG_MSG.Ve:console.log("服务器收到消息");break;case AG_MSG.Ce:console.log("收到消息");parseInt("0x"+k(O.slice(10,14)));var a=15;switch(O[14]){case MSG_TYPE.L:console.log("单聊消息");var _=parseInt("0x"+k(O.slice(a,a+2)));a+=2;var E=H(O.slice(a,a+_)),n=O[a+=_];switch(a+=1,n){case ENCRYPT_TYPE.m:var s=parseInt("0x"+k(O.slice(a,a+4)));a+=4;var r=b(O.slice(a,a+s));console.log(E,r.digest,r.content),2==(i=E.split("_")).length&&(E=i[1]),R(e={fromId:E,digest:r.digest,msg:r.content,msgNode:O.slice(2,10)},"onSingleMessage");break;case ENCRYPT_TYPE.g:}break;case MSG_TYPE.G:console.log("群消息");var c=parseInt("0x"+k(O.slice(a,a+2)));a+=2;var S=H(O.slice(a,a+c));a+=c;_=parseInt("0x"+k(O.slice(a,a+2)));a+=2;E=H(O.slice(a,a+_)),n=O[a+=_];switch(a+=1,n){case ENCRYPT_TYPE.m:s=parseInt("0x"+k(O.slice(a,a+4)));a+=4;r=b(O.slice(a,a+s));console.log(S,E,r.digest,r.content),2==(i=E.split("_")).length&&(E=i[1]),2==(I=S.split("_")).length&&(S=I[1]),R(e={groupId:S,fromId:E,digest:r.digest,msg:r.content,msgNode:O.slice(2,10)},"onGroupMessage");break;case ENCRYPT_TYPE.g:}break;case MSG_TYPE.l:console.log("群私信消息");c=parseInt("0x"+k(O.slice(a,a+2)));a+=2;S=H(O.slice(a,a+c));a+=c;_=parseInt("0x"+k(O.slice(a,a+2)));a+=2;E=H(O.slice(a,a+_)),n=O[a+=_];switch(a+=1,n){case ENCRYPT_TYPE.m:s=parseInt("0x"+k(O.slice(a,a+4)));a+=4;var i;r=b(O.slice(a,a+s));console.log(S,E,r.digest,r.content),2==(i=E.split("_")).length&&(E=i[1]),2==(I=S.split("_")).length&&(S=I[1]),R(e={groupId:S,fromId:E,digest:r.digest,msg:r.content,msgNode:O.slice(2,10)},"onGroupPrivateMessage");break;case ENCRYPT_TYPE.g:}break;case MSG_TYPE.D:console.log("推送群信息");c=parseInt("0x"+k(O.slice(a,a+2)));a+=2;S=H(O.slice(a,a+c));a+=c;s=parseInt("0x"+k(O.slice(a,a+4)));a+=4;var I;r=b(O.slice(a,a+s));console.log(S,r.digest,r.content),2==(I=S.split("_")).length&&(S=I[1]),R(e={groupId:S,digest:r.digest,msg:r.content,msgNode:O.slice(2,10)},"onGroupPushMessage");break;case MSG_TYPE.p:console.log("推送系统信息");s=parseInt("0x"+k(O.slice(a,a+4)));a+=4;r=b(O.slice(a,a+s));console.log(r.digest,r.content),R(e={digest:r.digest,msg:r.content,msgNode:O.slice(2,10)},"onSystemPushMessage")}break;case AG_MSG.Te:var o=parseInt("0x"+k(O.slice(2,4))),A=H(O.slice(6,O.byteLength));console.log("报错:",o,A),R(e={errId:o,errStr:A},"onErrorMessage");break;case AG_MSG.re:var N=parseInt("0x"+k(O.slice(2,4))),M=H(O.slice(4,4+N)),V=parseInt("0x"+k(O.slice(4+N,4+N+4)));c=parseInt("0x"+k(O.slice(4+N+4,4+N+4+2)));R({status:"success",statusStr:M,groupMsgIndex:V,groupId:S=H(O.slice(4+N+4+2,4+N+4+2+c)),serverTimestamp:parseInt("0x"+k(O.slice(4+N+4+2+c,4+N+4+2+c+4)))},"onSendGroupMsgFin");break;case AG_MSG.ce:N=parseInt("0x"+k(O.slice(2,4))),M=H(O.slice(4,4+N));var C=parseInt("0x"+k(O.slice(4+N,4+N+4)));c=parseInt("0x"+k(O.slice(4+N+4,4+N+4+2)));R({status:"success",statusStr:M,reqIndex:C,groupId:S=H(O.slice(4+N+4+2,4+N+4+2+c))},"onCreateGroupFin");break;case AG_MSG.Se:N=parseInt("0x"+k(O.slice(2,4))),M=H(O.slice(4,4+N)),C=parseInt("0x"+k(O.slice(4+N,4+N+4))),c=parseInt("0x"+k(O.slice(4+N+4,4+N+4+2)));R({status:"success",statusStr:M,reqIndex:C,groupId:S=H(O.slice(4+N+4+2,4+N+4+2+c))},"onDelGroupFin");break;case AG_MSG.ie:N=parseInt("0x"+k(O.slice(2,4))),M=H(O.slice(4,4+N)),C=parseInt("0x"+k(O.slice(4+N,4+N+4))),c=parseInt("0x"+k(O.slice(4+N+4,4+N+4+2)));R({status:"success",statusStr:M,reqIndex:C,groupId:S=H(O.slice(4+N+4+2,4+N+4+2+c))},"onAddGroupUserFin");break;case AG_MSG.Ie:N=parseInt("0x"+k(O.slice(2,4))),M=H(O.slice(4,4+N)),C=parseInt("0x"+k(O.slice(4+N,4+N+4))),c=parseInt("0x"+k(O.slice(4+N+4,4+N+4+2)));R({status:"success",statusStr:M,reqIndex:C,groupId:S=H(O.slice(4+N+4+2,4+N+4+2+c))},"onRemoveGroupUserFin");break;case AG_MSG.oe:N=parseInt("0x"+k(O.slice(2,4))),M=H(O.slice(4,4+N)),C=parseInt("0x"+k(O.slice(4+N,4+N+4))),c=parseInt("0x"+k(O.slice(4+N+4,4+N+4+2)));R({status:"success",statusStr:M,reqIndex:C,groupId:S=H(O.slice(4+N+4+2,4+N+4+2+c))},"onSetGroupMsgIgnoreFin");break;case AG_MSG.Ae:N=parseInt("0x"+k(O.slice(2,4))),M=H(O.slice(4,4+N)),C=parseInt("0x"+k(O.slice(4+N,4+N+4))),c=parseInt("0x"+k(O.slice(4+N+4,4+N+4+2)));R({status:"success",statusStr:M,reqIndex:C,groupId:S=H(O.slice(4+N+4+2,4+N+4+2+c))},"onUnsetGroupMsgIgnoreFin");break;case AG_MSG.Ne:N=parseInt("0x"+k(O.slice(2,4)));R({status:"success",statusStr:M=H(O.slice(4,4+N)),reqIndex:C=parseInt("0x"+k(O.slice(4+N,4+N+4)))},"onPushSystemMsgFin");break;case AG_MSG.Me:N=parseInt("0x"+k(O.slice(2,4))),M=H(O.slice(4,4+N)),C=parseInt("0x"+k(O.slice(4+N,4+N+4))),c=parseInt("0x"+k(O.slice(4+N+4,4+N+4+2)));R({status:"success",statusStr:M,reqIndex:C,groupId:S=H(O.slice(4+N+4+2,4+N+4+2+c))},"onPushGroupSystemMsgFin");break;case AG_MSG.ve:N=parseInt("0x"+k(O.slice(2,4))),M=H(O.slice(4,4+N)),C=parseInt("0x"+k(O.slice(4+N,4+N+4)));var u=parseInt("0x"+k(O.slice(4+N+4,4+N+4+4))),T=H(O.slice(4+N+4+4,4+N+4+4+u)).split(",");0==u&&(T=[]);for(var P=parseInt("0x"+k(O.slice(4+N+4+4+u,4+N+4+4+u+4))),L=H(O.slice(4+N+4+4+u+4,4+N+4+4+u+4+P)).split(","),G=parseInt("0x"+k(O.slice(4+N+4+4+u+4+P,4+N+4+4+u+4+P+4))),l=H(O.slice(4+N+4+4+u+4+P+4,4+N+4+4+u+4+P+4+G)).split(","),f=[],D=0;D<T.length;D++){var p={groupId:T[D],groupName:L[D],creator:l[D]};f.push(p)}R({status:"success",statusStr:M,reqIndex:C,groupsInfo:f},"onGetGroupList");break;case AG_MSG.He:N=parseInt("0x"+k(O.slice(2,4))),M=H(O.slice(4,4+N)),C=parseInt("0x"+k(O.slice(4+N,4+N+4)));var U=parseInt("0x"+k(O.slice(4+N+4,4+N+4+4)));R({status:"success",statusStr:M,reqIndex:C,userIdList:H(O.slice(4+N+4+4,4+N+4+4+U)).split(",")},"onGetGroupUserList");break;case AG_MSG.me:R({status:"success",count:parseInt("0x"+k(O.slice(2,6))),totalPageNum:d=parseInt("0x"+k(O.slice(6,8)))},"onGetOnlineNumber");break;case AG_MSG.we:var d=parseInt("0x"+k(O.slice(2,4))),v=parseInt("0x"+k(O.slice(4,6)));U=parseInt("0x"+k(O.slice(6,10)));R({status:"success",totalPageNum:d,reqPageNum:v,userIdList:H(O.slice(10,10+U)).split(",")},"onGetAllUserList");break;case AG_MSG.ye:R({status:"failed",totalPageNum:d=parseInt("0x"+k(O.slice(2,4))),reqPageNum:v=parseInt("0x"+k(O.slice(4,6)))},"onGetAllUserList")}},e.parseSrcMoonServerMessage=function(e,R){var O=new Uint8Array(e);switch(parseInt("0x"+k(O.slice(0,2)))){case AG_LIVESRCMOONSERVER.et:k(O.slice(18,20));var t=parseInt("0x"+k(O.slice(18,20)));R({type:"srcApplyUpload",status:"success",fingerprint:H(O.slice(20,20+t))});break;case AG_LIVESRCMOONSERVER.Rt:var a=parseInt("0x"+k(O.slice(2,4)));R({type:"srcApplyUpload",status:"failed",msg:i=H(O.slice(4,4+a))});break;case AG_LIVESRCMOONSERVER.Tt:console.log("webrtc心跳反馈");break;case AG_LIVESRCMOONSERVER.Pt:for(var _=parseInt("0x"+k(O.slice(2,3))),E=3,n=O.length,s={siv:_,uperInfos:{}};E<n;){var r=parseInt("0x"+k(O.slice(E,E+1)));E+=1;var c=parseInt("0x"+k(O.slice(E,E+2)));E+=2;var S=H(O.slice(E,E+c));E+=c,s.uperInfos[r]={upId:r,userId:S}}R({type:"uperStreamInfoUpdate",status:"success",msg:s});break;case AG_LIVESRCMOONSERVER.ut:R({type:"stopStream",status:"success"});break;case AG_LIVESRCMOONSERVER.At:R({type:"streamConfig",status:"success",channelId:H(O.slice(2,18))});break;case AG_LIVESRCMOONSERVER.Nt:R({type:"streamConfig",status:"failed",channelId:H(O.slice(2,18))});break;case AG_LIVESRCMOONSERVER.It:R({type:"delChannel",status:"success",channelId:H(O.slice(2,18))});break;case AG_LIVESRCMOONSERVER.ot:a=parseInt("0x"+k(O.slice(2,4)));var i=H(O.slice(4,4+a));R({type:"delChannel",status:"failed",channelId:H(O.slice(4+a,4+a+16)),msg:i});break;case AG_LIVESRCMOONSERVER.zO:R({type:"createChannel",status:"success",channelId:H(O.slice(2,18))});break;case AG_LIVESRCMOONSERVER.ZO:a=parseInt("0x"+k(O.slice(2,4)));R({type:"createChannel",status:"failed",msg:i=H(O.slice(4,4+a))});break;case AG_LIVESRCMOONSERVER.Lt:r=parseInt("0x"+k(O.slice(2,3))),_=parseInt("0x"+k(O.slice(3,4)));var I=H(O.slice(5));R({type:"streamData",status:"success",upId:r,siv:_,streamDataType:parseInt("0x"+k(O.slice(4,5))),streamData:I});break;case AG_LIVESRCMOONSERVER.Gt:(i={}).errId=parseInt("0x"+k(O.slice(2,4))),i.errStrlen=parseInt("0x"+k(O.slice(4,6))),i.errStr=H(O.slice(6,6+i.errStrlen)),R({type:"serverErr",status:"failed",msg:i});break;case AG_LIVESRCMOONSERVER.xt:t=parseInt("0x"+k(O.slice(2,4)));R({type:"webrtcReg",status:"success",fingerprint:H(O.slice(4,4+t))});break;case AG_LIVESRCMOONSERVER.Yt:R({type:"webrtcConnect",status:"success"})}},e.parseVdnMoonServerMessage=function(e,R){var O=new Uint8Array(e);switch(parseInt("0x"+k(O.slice(0,2)))){case AG_LIVEVDNMOONSERVER.Zt:var t=parseInt("0x"+k(O.slice(2,4)));R({type:"webrtcReg",status:"success",fingerprint:H(O.slice(4,4+t))});break;case AG_LIVEVDNMOONSERVER.$t:for(var a=H(O.slice(2,18)),_=parseInt("0x"+k(O.slice(18,19))),E=19,n=O.length,s={siv:_,uperInfos:{}};E<n;){var r=parseInt("0x"+k(O.slice(E,E+1)));E+=1;var c=parseInt("0x"+k(O.slice(E,E+2)));E+=2;var S=H(O.slice(E,E+c));E+=c,s.uperInfos[r]={upId:r,userId:S}}R({type:"vdnApplyDownload",status:"success",channelId:a,uperInfos:s});break;case AG_LIVEVDNMOONSERVER.ea:console.log("vdn 心跳反馈");break;case AG_LIVEVDNMOONSERVER.Ra:var i=parseInt("0x"+k(O.slice(2,4))),I=H(O.slice(4,4+i));R({type:"vdnApplyDownload",status:"failed",channelId:a=H(O.slice(4+i,4+i+16)),failedStatus:I});break;case AG_LIVEVDNMOONSERVER.Oa:R({type:"streamConfig",status:"success",channelId:a=H(O.slice(2,18))});break;case AG_LIVEVDNMOONSERVER.ta:R({type:"streamConfig",status:"failed",channelId:a=H(O.slice(2,18))});break;case AG_LIVEVDNMOONSERVER.aa:for(a=H(O.slice(2,18)),_=parseInt("0x"+k(O.slice(18,19))),E=19,n=O.length,s={channelId:a,siv:_,uperInfos:{}};E<n;){r=parseInt("0x"+k(O.slice(E,E+1)));E+=1;c=parseInt("0x"+k(O.slice(E,E+2)));E+=2;S=H(O.slice(E,E+c));E+=c,s.uperInfos[r]={upId:r,userId:S}}R({type:"uperStreamInfoUpdate",status:"success",channelId:a,msg:s});break;case AG_LIVEVDNMOONSERVER._a:R({type:"streamData",status:"success",upId:r=parseInt("0x"+k(O.slice(2,3))),siv:_=parseInt("0x"+k(O.slice(3,4))),streamDataType:parseInt("0x"+k(O.slice(4,5))),streamData:H(O.slice(5))});break;case AG_LIVEVDNMOONSERVER.Ea:break;case AG_LIVEVDNMOONSERVER.ia:R({type:"webrtcConnect",status:"success"});break;case AG_LIVEVDNMOONSERVER.na:case AG_LIVEVDNMOONSERVER.sa:break;case AG_LIVEVDNMOONSERVER.ca:var o={};o.errId=parseInt("0x"+k(O.slice(2,4))),o.errStrlen=parseInt("0x"+k(O.slice(4,6))),o.errStr=H(O.slice(6,6+o.errStrlen)),R({type:"serverErr",status:"failed",msg:o})}},e.parseChatMoonServerMessage=function(e,R){var O=new Uint8Array(e),t=parseInt("0x"+k(O.slice(0,2)));switch(t){case AG_CHATROOMMOONSERVER.Ze:R({type:"createChatRoom",status:"success",chatroomId:_=H(O.slice(2,18)),maxContentLen:parseInt("0x"+k(O.slice(18,20)))});break;case AG_CHATROOMMOONSERVER.$e:var a=parseInt("0x"+k(O.slice(2,4)));R({type:"createChatRoom",status:"failed",status:H(O.slice(4,4+a))});break;case AG_CHATROOMMOONSERVER.eR:R({type:"deleteChatRoom",status:"success",roomId:_=H(O.slice(2,18))});break;case AG_CHATROOMMOONSERVER.RR:var _=H(O.slice(2,18));a=parseInt("0x"+k(O.slice(18,20)));R({type:"deleteChatRoom",status:"failed",msg:H(O.slice(20,20+a)),roomId:_});break;case AG_CHATROOMMOONSERVER.OR:var E=parseInt("0x"+k(O.slice(2,4)));R({type:"banaedToSendMsg",status:"success",banUserId:n=H(O.slice(4,4+E)),banTime:s=parseInt("0x"+k(O.slice(4+E,4+E+2)))});break;case AG_CHATROOMMOONSERVER.tR:E=parseInt("0x"+k(O.slice(2,4)));var n=H(O.slice(4,4+E)),s=parseInt("0x"+k(O.slice(4+E,4+E+2)));a=parseInt("0x"+k(O.slice(4+E+2,4+E+2+2)));R({type:"banaedToSendMsg",status:"failed",banUserId:n,banTime:s,msg:H(O.slice(4+E+2+2,4+E+2+2+a))});break;case AG_CHATROOMMOONSERVER.aR:var r=parseInt("0x"+k(O.slice(2,4)));R({type:"kickOutUser",status:"success",kickOutUserId:c=H(O.slice(4,4+r))});break;case AG_CHATROOMMOONSERVER._R:r=parseInt("0x"+k(O.slice(2,4)));var c=H(O.slice(4,4+r));a=parseInt("0x"+k(O.slice(4+r,4+E+2)));R({type:"kickOutUser",status:"failed",kickOutUserId:c,msg:H(O.slice(4+r+2,4+r+2+a))});break;case AG_CHATROOMMOONSERVER.ER:case AG_CHATROOMMOONSERVER.nR:R({type:"joinChatRoom",status:"success",roomId:_=H(O.slice(2,18)),maxContentLen:parseInt("0x"+k(O.slice(18,20)))});break;case AG_CHATROOMMOONSERVER.sR:_=H(O.slice(2,18)),a=parseInt("0x"+k(O.slice(18,20)));R({type:"joinChatRoom",status:"failed",failedStatus:H(O.slice(20,20+a)),roomId:_});break;case AG_CHATROOMMOONSERVER.rR:console.log("chatRoom心跳反馈");break;case AG_CHATROOMMOONSERVER.cR:case AG_CHATROOMMOONSERVER.SR:var S=parseInt("0x"+k(O.slice(2,4))),i=H(O.slice(4,4+S)),I=parseInt("0x"+k(O.slice(4+S,4+S+4))),o=H(O.slice(4+S+4,4+S+4+I));R({type:t==AG_CHATROOMMOONSERVER.cR?"recvChatPrivateMsg":"recvChatMsg",status:"success",fromUserId:i,msg:o});break;case AG_CHATROOMMOONSERVER.iR:R({type:"chatroomUserBannedMsg",status:"success",banTime:s=parseInt("0x"+k(O.slice(2,4)))});break;case AG_CHATROOMMOONSERVER.IR:R({type:"chatroomUserKicked",status:"success"});break;case AG_CHATROOMMOONSERVER.oR:R({type:"sendMsgNoFree"});break;case AG_CHATROOMMOONSERVER.AR:(o={}).errId=parseInt("0x"+k(O.slice(2,4))),o.errStrlen=parseInt("0x"+k(O.slice(4,6))),o.errStr=H(O.slice(6,6+o.errStrlen)),R({type:"serverErr",status:"failed",msg:o});break;case AG_CHATROOMMOONSERVER.NR:R({type:"getRoomOnlineNum",status:"success",roomId:_=H(O.slice(2,18)),onlineNum:parseInt("0x"+k(O.slice(18,22)))});break;case AG_CHATROOMMOONSERVER.lR:R({type:"saveToChatroomList",status:"success",roomId:_=H(O.slice(2,18))});break;case AG_CHATROOMMOONSERVER.fR:R({type:"saveToChatroomList",status:"failed",roomId:_=H(O.slice(2,18))});break;case AG_CHATROOMMOONSERVER.pR:R({type:"delFromToChatroomList",status:"success",roomId:_=H(O.slice(2,18))});break;case AG_CHATROOMMOONSERVER.UR:R({type:"delFromToChatroomList",status:"failed",roomId:_=H(O.slice(2,18))});break;case AG_CHATROOMMOONSERVER.vR:var A=parseInt("0x"+k(O.slice(2,6)));R({type:"queryAllChatroomList",status:"success",listData:H(O.slice(6,6+A))})}},e.parseVoipMoonServerMessage=function(e,R){var O=new Uint8Array(e);switch(parseInt("0x"+k(O.slice(0,2)))){case AG_VOIPMOONSERVER.YR:R({type:"voipCallingAck",status:"success"});break;case AG_VOIPMOONSERVER.KR:var t=parseInt("0x"+k(O.slice(2,4)));R({type:"voipCalling",status:"success",fingerprint:H(O.slice(4,4+t))});break;case AG_VOIPMOONSERVER.WR:(a={}).errId=parseInt("0x"+k(O.slice(2,4))),a.errStrlen=parseInt("0x"+k(O.slice(4,6))),a.errStr=H(O.slice(6,6+a.errStrlen)),R({type:"voipCalling",status:"failed",msg:a});break;case AG_VOIPMOONSERVER.qR:t=parseInt("0x"+k(O.slice(2,4)));R({type:"voipResponseing",status:"success",fingerprint:H(O.slice(4,4+t))});break;case AG_VOIPMOONSERVER.JR:(a={}).errId=parseInt("0x"+k(O.slice(2,4))),a.errStrlen=parseInt("0x"+k(O.slice(4,6))),a.errStr=H(O.slice(6,6+a.errStrlen)),R({type:"voipResponseing",status:"failed",msg:a});break;case AG_VOIPMOONSERVER.QR:case AG_VOIPMOONSERVER.jR:break;case AG_VOIPMOONSERVER.XR:var a;(a={}).errId=parseInt("0x"+k(O.slice(2,4))),a.errStrlen=parseInt("0x"+k(O.slice(4,6))),a.errStr=H(O.slice(6,6+a.errStrlen)),R({type:"serverErr",status:"failed",msg:a})}},e.constructHeartBeatMsg=function(e){return new Uint8Array(J(W(e.toString(16))))}},StarRtc.StarConfig=function(){this.configModePulic=!1,this.configUseAEC=!1,this.msgServerUrl="demo.starrtc.com",this.msgServerWebsocketPort="9904",this.chatRoomServerUrl="demo.starrtc.com",this.chatRoomServerWebsocketPort="9907",this.srcServerUrl="demo.starrtc.com",this.srcServerWebsocketPort="9929",this.srcServerWebrtcPort="10088",this.srcServerWebrtcPort="demo.starrtc.com",this.vdnServerUrl="demo.starrtc.com",this.vdnServerWebsocketPort="9929",this.vdnServerWebrtcPort="10088",this.vdnServerWebrtcPort="demo.starrtc.com",this.voipServerUrl="demo.starrtc.com",this.voipServerPort="10086",this.voipServerWebsocketPort="10087",this.voipServerWebrtcPort="10088",this.voipServerWebrtcPort="demo.starrtc.com"},StarRtc.StarUserInfo=function(){this.agentId="",this.userId="",this.starUid="",this.starToken=""},StarRtc.StarStaticInterface=new function(){var S=this;S.reportRoom=function(e,R,O,t,a,_){var E=null,n=a.id.substring(16,33),s={};s.id=a.id,s.creator=a.creator,s.name=a.name;var r=function(e,R){switch(e.obj=S,R){case"connect success":E.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.O,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.GR,{roomId:n,listType:t,userDefineData:encodeURIComponent(JSON.stringify(s))},O)));break;case"connect failed":_&&_("failed");case"connect closed":E=null;break;case"onmessage":StarRtc.AUtils.parseProtocol(e,function(e){e.appid==APP_PRODUCT_ID.O&&StarRtc.AUtils.parseChatMoonServerMessage(e.msgArr,function(e){r(e,"onChatRoomMessage")})});break;case"onChatRoomMessage":switch(e.type){case"saveToChatroomList":_&&_(e.status),E.close()}}},c="wss://"+e+":"+R;(E=new StarRtc.WebrtcWebsocket(r,null)).connect(c)},S.queryRoom=function(e,R,a,_,E){var n=null,s=function(e,R){switch(e.obj=S,R){case"connect success":n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.O,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.dR,{listTypes:_.toString(),userId:""},a)));break;case"connect failed":E&&E("failed",[]);case"connect closed":n=null;break;case"onmessage":StarRtc.AUtils.parseProtocol(e,function(e){e.appid==APP_PRODUCT_ID.O&&StarRtc.AUtils.parseChatMoonServerMessage(e.msgArr,function(e){s(e,"onChatRoomMessage")})});break;case"onChatRoomMessage":switch(e.type){case"queryAllChatroomList":if(""==e.listData){E&&E(e.status,[]);break}for(var O=JSON.parse(e.listData).userDefineDataList.split(","),t=0;t<O.length;t++)O[t]=JSON.parse(decodeURIComponent(O[t]));E&&E(e.status,O),n.close()}}},O="wss://"+e+":"+R;(n=new StarRtc.WebrtcWebsocket(s,null)).connect(O)},S.delRoom=function(e,R,O,t,a,_){var E=null,n=a.id.substring(16,33),s=function(e,R){switch(e.obj=S,R){case"connect success":E.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.O,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.DR,{roomId:n,listType:t},O)));break;case"connect failed":_&&_("failed");case"connect closed":E=null;break;case"onmessage":StarRtc.AUtils.parseProtocol(e,function(e){e.appid==APP_PRODUCT_ID.O&&StarRtc.AUtils.parseChatMoonServerMessage(e.msgArr,function(e){s(e,"onChatRoomMessage")})});break;case"onChatRoomMessage":switch(e.type){case"delFromToChatroomList":_&&_(e.status),E.close()}}},r="wss://"+e+":"+R;(E=new StarRtc.WebrtcWebsocket(s,null)).connect(r)}},StarRtc.StarSDK=function(){var e="starRTC v1.1.2",n=this,a=null,_=null,E=0;n.starConfig=new StarRtc.StarConfig,n.starUser=new StarRtc.StarUserInfo;var s=null;n.version=function(){return console.log(e),e};var r=function(e,R){switch(R){case"connect success":n.startAuth(),a(e,R);break;case"connect failed":case"connect closed":s=null,a(e,R);break;case"onmessage":StarRtc.AUtils.parseProtocol(e,function(e){switch(e.appid){case APP_PRODUCT_ID.R:StarRtc.AUtils.parseMessage(e.msgArr,r)}});break;case"onSingleMessage":null!=e.msgNode&&(c(e.msgNode,n.starUser),e.msgNode=void 0),e.msg=JSON.parse(e.msg);var O=R;if(0==e.msg.type)switch(e.msg.code){case AG_MSG_VOIP_CTRL.h:e.type="voipCall",O="onVoipMessage";break;case AG_MSG_VOIP_CTRL.Y:e.type="voipAudioCall",O="onVoipMessage";break;case AG_MSG_VOIP_CTRL.F:e.type="voipRefuse",O="onVoipMessage";break;case AG_MSG_VOIP_CTRL.K:e.type="voipHangup",O="onVoipMessage";break;case AG_MSG_VOIP_CTRL.W:e.type="voipBusy",O="onVoipMessage";break;case AG_MSG_VOIP_CTRL.B:e.type="voipConnect",O="onVoipMessage";break;default:e.type="voipSingleMsg"}else e.type="voipSingleMsg";(null!=_?_:a)(e,O);break;case"onLoginMessage":if("success"==e.status){e.msgMaxLen;var t=StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructHeartBeatMsg(AG_MSG.X));null!=s&&s.startHeartBeat(t,15e3)}case"onGroupMessage":case"onGroupPrivateMessage":case"onGroupPushMessage":case"onSystemPushMessage":null!=e.msgNode&&(c(e.msgNode,n.starUser),e.msgNode=void 0);case"onErrorMessage":case"onGetGroupList":case"onGetOnlineNumber":case"onGetGroupUserList":case"onGetAllUserList":case"onPushGroupSystemMsgFin":case"onPushSystemMsgFin":case"onUnsetGroupMsgIgnoreFin":case"onSetGroupMsgIgnoreFin":case"onRemoveGroupUserFin":case"onAddGroupUserFin":case"onDelGroupFin":case"onCreateGroupFin":case"onSendGroupMsgFin":null!=_&&_(e,R),a(e,R)}};function c(e,R){console.log("发送消息回执"),n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructReceivedMsg(e,R)))}return n.setMsgServerInfo=function(e,R){n.starConfig.msgServerUrl=e,n.starConfig.msgServerWebsocketPort=R},n.setChatRoomServerInfo=function(e,R){n.starConfig.chatRoomServerUrl=e,n.starConfig.chatRoomServerWebsocketPort=R},n.setSrcServerInfo=function(e,R,O,t){n.starConfig.srcServerUrl=e,n.starConfig.srcServerWebsocketPort=R,n.starConfig.srcServerWebrtcPort=O,n.starConfig.srcServerWebrtcIP=t||e},n.setVdnServerInfo=function(e,R,O,t){n.starConfig.vdnServerUrl=e,n.starConfig.vdnServerWebsocketPort=R,n.starConfig.vdnServerWebrtcPort=O,n.starConfig.vdnServerWebrtcIP=t||e},n.setVoipServerInfo=function(e,R,O,t,a){n.starConfig.voipServerUrl=e,n.starConfig.voipServerPort=R,n.starConfig.voipServerWebsocketPort=O,n.starConfig.voipServerWebrtcPort=t,n.starConfig.voipServerWebrtcIP=a||e},n.setConfigUseAEC=function(e){n.starConfig.configUseAEC=e},n.login=function(e,R,O){n.starConfig.configModePulic||(e="APPID-FREE"),n.starUser.agentId=e,n.starUser.userId=R,n.starUser.starUid=e+"_"+R,a=O,function(e){if("WebSocket"in window){n.starUser.agentId,n.starUser.userId,n.starUser.starUid;n.starConfig.configModePulic||(n.starUser.starToken="free",(s=new StarRtc.WebrtcWebsocket(e,null)).connect("wss://"+n.starConfig.msgServerUrl+":"+n.starConfig.msgServerWebsocketPort))}else console.log("当前浏览器 Not support websocket"),e({msg:"当前浏览器 Not support websocket"},"connect failed")}(r)},window.onbeforeunload=function(){n.logout()},n.logout=function(){null!=s&&(s.close(),s=null)},n.send=function(e){null!=s&&s.send(e)},n.startAuth=function(){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructAuthMsg(n.starUser)))},n.sendSingleMsg=function(e,R,O,t){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructSingleMsg(e,++E,R,O,t,n.starUser)))},n.sendGroupMsg=function(e,R,O){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructGroupMsg(e,++E,R,O,n.starUser)))},n.sendSingleCtrlMsg=function(e,R,O,t){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructSingleCtrlMsg(e,++E,R,O,t,n.starUser)))},n.sendVoipCtrlMsg=function(e,R){var O="";R!=AG_MSG_VOIP_CTRL.h&&R!=AG_MSG_VOIP_CTRL.Y||(O=JSON.stringify({VoIP_protocal_type:"TCP",VoIP_server_IP:n.starConfig.voipServerUrl,VoIP_server_Port:n.starConfig.voipServerPort})),n.sendSingleCtrlMsg(e,"新消息",O,R)},n.sendVoipCallMsg=function(e,R,O){var t;O=O||!1;var a=R||(new Date).getTime();t=JSON.stringify({VoIP_protocal_type:"TCP",VoIP_server_IP:n.starConfig.voipServerUrl,VoIP_server_Port:n.starConfig.voipServerPort,ts:a}),n.sendSingleCtrlMsg(e,"新消息",t,O?AG_MSG_VOIP_CTRL.Y:AG_MSG_VOIP_CTRL.h)},n.sendVoipRefuseMsg=function(e){n.sendVoipCtrlMsg(e,AG_MSG_VOIP_CTRL.F)},n.sendVoipHungupMsg=function(e){n.sendVoipCtrlMsg(e,AG_MSG_VOIP_CTRL.K),null!=_&&_({type:"voipCancle"},"onVoipMessage")},n.sendVoipBusyMsg=function(e){n.sendVoipCtrlMsg(e,AG_MSG_VOIP_CTRL.W)},n.sendVoipConnectMsg=function(e){n.sendVoipCtrlMsg(e,AG_MSG_VOIP_CTRL.B)},n.setIMExtraback=function(e){_=e},n.getStarRoomSDK=function(e,R,O,t,a,_,E){return new StarRtc.StarRoomSDK(e,R,O,t,a,_,E,n.starUser,n.starConfig)},n.getVideoMeetingRoomSDK=function(e,R,O){return n.getStarRoomSDK("src",e,R,O,3,CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_MEETING)},n.getVideoLiveRoomSDK=function(e,R,O,t){return n.getStarRoomSDK(e,R,O,t,3,CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_LIVE)},n.getVoipRoomSDK=function(e,R,O){return n.getStarRoomSDK("voip",e,R,O,2,0,n)},n.getChatRoomSDK=function(e,R,O){return new StarRtc.StarChatRoomSDK(e,R,O,CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_CHATROOM,n.starUser,n.starConfig)},n.getVideoRoomSDK=function(e,R,O,t,a){return new StarRtc.StarVideoRoomSDK(e,R,O,t,a,n.starUser,n.starConfig)},n.queryRoom=function(e,R){n.starConfig.configUseAEC||StarRtc.StarStaticInterface.queryRoom(n.starConfig.chatRoomServerUrl,n.starConfig.chatRoomServerWebsocketPort,n.starUser,e.join(","),R)},n.setGroupMsgPush=function(e){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(e?AG_MSG.ae:AG_MSG._e,{reqIndex:0},n.starUser)))},n.removeGroupUsers=function(e,R){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(AG_MSG.te,{reqIndex:0,groupId:e,removeUsers:R.join(",")},n.starUser)))},n.addGroupUsers=function(e,R,O){O=O||"",n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(AG_MSG.Oe,{reqIndex:0,groupId:e,addUsers:R.join(","),userDefineData:O},n.starUser)))},n.delGroup=function(e){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(AG_MSG.Re,{reqIndex:0,groupId:e},n.starUser)))},n.createGroup=function(e,R){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(AG_MSG.ee,{reqIndex:0,addUsers:e.join(","),userDefineData:R},n.starUser)))},n.getGroupList=function(){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(AG_MSG.de,{reqIndex:0},n.starUser)))},n.getGroupUserList=function(e){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(AG_MSG.be,{reqIndex:0,groupId:e},n.starUser)))},n.getOnlineNumber=function(){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(AG_MSG.ke,{},n.starUser)))},n.getAllUserList=function(e){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(AG_MSG.ge,{reqPageNum:e},n.starUser)))},n.getSuperRoomSDK=function(e,R,O){return new StarRtc.StarSuperRoomSDK(e,R,O,n.starUser,n.starConfig)},n.reportRoom=function(e,R,O){n.starConfig.configUseAEC||StarRtc.StarStaticInterface.reportRoom(n.starConfig.chatRoomServerUrl,n.starConfig.chatRoomServerWebsocketPort,n.starUser,e,R,O)},n.delRoom=function(e,R,O){n.starConfig.configUseAEC||StarRtc.StarStaticInterface.reportRoom(n.starConfig.chatRoomServerUrl,n.starConfig.chatRoomServerWebsocketPort,n.starUser,e,R,O)},n},StarRtc.WebrtcWebsocket=function(e,R){var t,O=this,a=e,_=null;return O.startHeartBeat=function(e,R){var O=R||5e3;_.send(e),t=setInterval(function(){_.send(e)},O)},O.stopHeartBeat=function(){clearInterval(t)},O.connect=function(e){console.log("webrtcConnect"+e),(_=new WebSocket(e)).onerror=function(e){console.log("WebSocket连接发生错误"),a({msg:"WebSocket连接发生错误",data:e.data},"connect failed")},_.onopen=function(){console.log("WebSocket连接成功"),a({msg:"WebSocket连接成功"},"connect success")},_.onmessage=function(e){console.log("onmessage",e.data),a(e.data,"onmessage")},_.onclose=function(e){console.log("WebSocket连接关闭"),O.stopHeartBeat(),a({msg:"WebSocket连接关闭",data:e.code},"connect closed"),_=null}},O.send=function(e){_.send(e)},O.close=function(){null!=_&&_.close()},O.readyState=function(){return null!=_?_.readyState:-1},O},StarRtc.StarSuperRoomSDK=function(e,R,O,t,a){var _=this,E=e,n=O,s=R,r=null,c=null,S=null,i=null,I=null,o=null,A=!1,N=t||new StarRtc.StarUserInfo,M=a||new StarRtc.StarConfig;function V(e){if(null!=e){var R=e.getState();0<=R&&R<2&&e.sigDisconnect()}}function C(){return!(3!=I.getState()&&-1!=I.getState()||3!=S.getState()&&-1!=S.getState()||null!=r&&(null==r||3!=r.getState()&&-1!=r.getState()))}var u=function(e,R,O){switch(e.userData=n,e.obj=_,R){case"connect success":switch(O){case"open":r.createStream({video:!1,audio:{deviceId:{ideal:["default"]}}});break;case"new":r.createNewSuperRoom()}break;case"connect closed":case"connect failed":r=null;break;case"onmessage":break;case"onWebrtcMessage":switch(e.type){case"srcApplyUpload":s(e,R,E);break;case"streamCreated":"success"==e.status?r.joinRoom():s(e,R,E);break;case"delChannel":"success"==e.status?s(e,R,E):alert("删除视频会议失败");break;case"createChannel":"success"==e.status&&(n.roomInfo.creator=N.userId,n.roomInfo.id=e.channelId+n.roomInfo.id,i.roomInfo.id=e.channelId,i.roomInfo.creator=N.userId,c.roomInfo.id=e.channelId,c.roomInfo.creator=N.userId,r.sigDisconnect()),s(e,R,E)}}};return c=clone(n),i=clone(n),o=clone(n),n.roomInfo.id&&(c.roomInfo.id=n.roomInfo.id.substring(0,16),i.roomInfo.id=n.roomInfo.id.substring(0,16),o.roomInfo.id=n.roomInfo.id.substring(16,33)),S=new StarRtc.StarVideoSDK("vdn","open",function(e,R){switch(e.userData=n,e.obj=_,R){case"connect success":s(e,R,E);break;case"connect closed":case"connect failed":V(I),V(r),C()&&s(e,R,E);break;case"onmessage":break;case"onWebrtcMessage":e.type,s(e,R,E)}},i,CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_SUPER_ROOM,N,M),I=new StarRtc.StarChatSDK(e,function(e,R){switch(e.userData=n,e.obj=_,R){case"connect success":S.sigConnect();break;case"connect failed":case"connect closed":V(S),C()&&s(e,R,E);break;case"onmessage":break;case"onChatRoomMessage":switch(e.type){case"createChatRoom":"success"==e.status&&(n.roomInfo.id=e.chatroomId,n.roomInfo.creator=N.userId,c.roomInfo.chatroomId=e.chatroomId,i.roomInfo.chatroomId=e.chatroomId,(r=new StarRtc.StarVideoSDK("src","new",u,c,CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_SUPER_ROOM,N,M)).sigConnect());break;case"deleteChatRoom":"success"==e.status&&r.deleteCurrRoom();break;case"joinChatRoom":"success"==e.status&&S.joinRoom()}s(e,R,E)}},o,CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_SUPER_ROOM,N,M),_.sigConnect=function(){A=!1,I.sigConnect()},_.sigDisconnect=function(e){null==e&&(e=!0),A=e,_.endTalk(e),S.sigDisconnect(e)},_.createNew=function(){I.createNew()},_.deleteCurrRoom=function(){I.deleteCurrRoom()},_.createStream=function(e){null==e?e={video:!1,audio:{deviceId:{ideal:["default"]}}}:e.video=!1,S.createStream(e)},_.joinRoom=function(){"new"!=E?I.joinRoom():S.joinRoom()},_.leaveRoom=function(e){_.endTalk(),S.leaveRoom(e)},_.sendChatMsg=function(e){I.sendChatMsg(e)},_.sendChatPrivateMsg=function(e,R){I.sendChatPrivateMsg(e,R)},_.kickOutUser=function(e){I.kickOutUser(e)},_.banToSendMsg=function(e,R){I.banToSendMsg(e,R)},_.getRoomOnlineNum=function(){I.getRoomOnlineNum()},_.activeDisconnect=function(){return A},_.startTalk=function(){null==r&&(r=new StarRtc.StarVideoSDK("src","open",u,c,CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_SUPER_ROOM,N,M)).sigConnect()},_.endTalk=function(){null!=r&&(r.sigDisconnect(),r=null)},_},StarRtc.StarRoomSDK=function(e,R,O,t,a,_,E,n,s){var r="我要上麦！",c=this,S=n||new StarRtc.StarUserInfo,i=s||new StarRtc.StarConfig,I=R,o=e,A=t,N=O,M=a||3,V=0!=(1&M),C=0!=(2&M);"open"==R&&32!=A.roomInfo.id.length&&(V=!1);var u=null,T=null,P=null,L=null,G=!1,l=null,f=E;function D(){null!=l&&(clearInterval(l),l=null)}function p(e){if(null!=e){var R=e.getState();0<=R&&R<2&&e.sigDisconnect()}}function U(){var e=!0;return V&&(e=e&&(3==P.getState()||-1==P.getState())),C&&(e=e&&(3==u.getState()||-1==u.getState())),e}null!=f&&"voip"==e&&f.setIMExtraback(function(e,R){d(e,"onVoipMessage")});var d=function(e,R){switch(e.userData=A,e.obj=c,R){case"connect success":C?u.sigConnect():N(e,R,I);break;case"connect failed":case"connect closed":C&&p(u),U()&&N(e,R,I);break;case"onmessage":break;case"onChatRoomMessage":switch(e.type){case"createChatRoom":"success"==e.status&&(A.roomInfo.id=e.chatroomId,A.roomInfo.creator=S.userId,C&&(T.roomInfo.chatroomId=e.chatroomId,u.createNew()));break;case"deleteChatRoom":"success"==e.status&&(C?u.deleteCurrRoom():N(e,R,I));break;case"joinChatRoom":"success"==e.status&&C&&u.joinRoom();break;case"recvChatPrivateMsg":if(0==e.msg.type)switch(e.msg.code){case 2e3:e.msg.msgType="apply";break;case 2002:e.msg.msgType="applyAgree";break;case 2004:e.msg.msgType="applyDisagree";break;case 2200:e.msg.msgType="linkStop";break;case 2100:e.msg.msgType="invite";break;case 2102:e.msg.msgType="inviteAgree";break;case 2106:e.msg.msgType="inviteDisagree";break;case 2104:e.msg.msgType="inviteLinkStart";break;default:e.msg.msgType="common"}}N(e,R,I);break;case"onVoipMessage":switch(e.type){case"voipCall":e.fromId!=A.roomInfo.targetId&&f.sendVoipBusyMsg(e.fromId);break;case"voipHangup":e.fromId==A.roomInfo.targetId&&(c.leaveRoom(!0),N(e,R,I));break;case"voipBusy":D(),c.leaveRoom(!0),N(e,R,I);break;case"voipConnect":case"voipRefuse":D(),N(e,R,I);break;case"voipCancle":D();break;default:N(e,R,I)}}};return T=clone(A),L=clone(A),C&&V&&A.roomInfo.id&&(T.roomInfo.id=A.roomInfo.id.substring(0,16),L.roomInfo.id=A.roomInfo.id.substring(16,33)),C&&(u=new StarRtc.StarVideoSDK(e,R,function(e,R){switch(e.userData=A,e.obj=c,R){case"connect success":N(e,R,I);break;case"connect closed":case"connect failed":D(),V&&p(P),U()&&N(e,R,I);break;case"onmessage":break;case"onWebrtcMessage":switch(e.type){case"delChannel":"success"==e.status?N(e,R,I):alert("删除视频会议失败");break;case"createChannel":"success"==e.status&&(A.roomInfo.creator=S.userId,A.roomInfo.id=V?e.channelId+A.roomInfo.id:e.channelId),N(e,R,I);break;case"voipCallingAck":if(null!=f){D();var O=(new Date).getTime();f.sendVoipCallMsg(A.roomInfo.targetId,O,A.roomInfo.audioOnly),_=A.roomInfo.targetId,t=function(){f.sendVoipCallMsg(_,O,A.roomInfo.audioOnly)},a=3e3,null!=l&&D(),l=setInterval(t,a)}break;case"voipResponseing":"success"==e.status&&null!=f&&f.sendVoipConnectMsg(A.roomInfo.targetId),N(e,R,I);break;default:N(e,R,I)}}var t,a,_},T,_,S,i)),V&&(P=new StarRtc.StarChatSDK(R,d,L,_,S,i)),c.sigConnect=function(){G=!1,V?P.sigConnect():C&&u.sigConnect()},c.sigDisconnect=function(e){null==e&&(e=!0),G=e,C?u.sigDisconnect(e):V&&P.sigDisconnect(e)},c.createNew=function(){"voip"!=o&&(V?P.createNew():C&&u.createNew())},c.deleteCurrRoom=function(){"voip"!=o&&(V?P.deleteCurrRoom():C&&u.deleteCurrRoom())},c.createStream=function(e){C&&u.createStream(e)},c.createScreenCaptureStream=function(e){C&&u.createScreenCaptureStream(e)},c.joinRoom=function(){V&&"new"!=I?P.joinRoom():C&&u.joinRoom()},c.leaveRoom=function(e){if(C){switch(o){case"voip":var R=e||!1;null==f||R||f.sendVoipHungupMsg(A.roomInfo.targetId),f.setIMExtraback(null)}u.leaveRoom(R)}else V&&P.leaveRoom()},c.streamConfigChange=function(e){C&&u.streamConfigChange(e)},c.streamConfigApply=function(e){C&&u.streamConfigApply(e)},c.sendChatMsg=function(e){V&&P.sendChatMsg(e)},c.sendVoipMsg=function(e){"voip"==o&&null!=f&&f.sendSingleMsg(A.roomInfo.targetId,"新媒体",e)},c.sendChatPrivateMsg=function(e,R){V&&P.sendChatPrivateMsg(e,R)},c.sendApplyMsg=function(){V&&C&&"vdn"==o&&P.sendChatCtrlPrivateMsg(A.roomInfo.creator,r,2e3)},c.sendApplyAgreeMsg=function(e){V&&C&&"src"==o&&P.sendChatCtrlPrivateMsg(e,r,2002)},c.sendApplyDisagreeMsg=function(e){V&&C&&"src"==o&&P.sendChatCtrlPrivateMsg(e,r,2004)},c.sendInviteLinkMsg=function(e){V&&C&&"src"==o&&P.sendChatCtrlPrivateMsg(e,r,2100)},c.sendInviteLinkAgreeMsg=function(){V&&C&&"vdn"==o&&P.sendChatCtrlPrivateMsg(A.roomInfo.creator,r,2102)},c.sendInviteLinkDisagreeMsg=function(){V&&C&&"vdn"==o&&P.sendChatCtrlPrivateMsg(A.roomInfo.creator,r,2106)},c.sendInviteLinkStartMsg=function(){V&&C&&"vdn"==o&&P.sendChatCtrlPrivateMsg(A.roomInfo.creator,r,2104)},c.sendLinkStopMsg=function(e){V&&C&&"src"==o&&P.sendChatCtrlPrivateMsg(e,r,2200)},c.kickOutUser=function(e){V&&P.kickOutUser(e)},c.banToSendMsg=function(e,R){V&&P.banToSendMsg(e,R)},c.getRoomOnlineNum=function(){V&&P.getRoomOnlineNum()},c.sendStreamData=function(e){C&&"src"==o&&u.sendStreamData(e)},c.activeDisconnect=function(){return G},c},StarRtc.StarVideoRoomSDK=function(e,R,O,t,a,_,E){var n=this,s=t,r=O,c=R,S=e,i=a||CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_MEETING,I=_||new StarRtc.StarUserInfo,o=E||new StarRtc.StarConfig,A=new StarRtc.StarVideoSDK(S,c,function(e,R){e.userData=s,e.obj=n,r(e,R,c)},s,i,I,o);return n.sigConnect=function(){A.sigConnect()},n.sigDisconnect=function(e){A.sigDisconnect(e)},n.createNew=function(){A.createNew()},n.createNewSuperRoom=function(){A.createNewSuperRoom()},n.deleteCurrRoom=function(){A.deleteCurrRoom()},n.createStream=function(e){A.createStream(e)},n.createScreenCaptureStream=function(e){A.createScreenCaptureStream(e)},n.joinRoom=function(){A.joinRoom()},n.leaveRoom=function(e){A.leaveRoom(e)},n.streamConfigChange=function(e){A.streamConfigChange(e)},n.streamConfigApply=function(e){A.streamConfigApply(e)},n.getState=function(){return A.getState()},n.getType=function(){return A.getType()},n.sendStreamData=function(e){A.sendStreamData(e)},n.activeDisconnect=function(){return A.activeDisconnect()},n},StarRtc.StarVideoSDK=function(e,R,O,t,a,_,E){var s=this,r=t,c=e,S=O,i=R,I=null,o="",A={},N={},M=_||new StarRtc.StarUserInfo,n=E||new StarRtc.StarConfig,V=a||CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_MEETING,C={siv:0,uperInfos:{}},u=StarWebRTC();u.init();var T=!1,P=!1,L=function(e){switch(e.type){case"createOffer":if("success"==e.status){switch(c){case"src":e.channelId=r.roomInfo.id;break;case"vdn":e.ssrc=e.bigVideoSSRC;break;case"voip":e.targetId=r.roomInfo.targetId,e.videoSSRC=e.bigVideoSSRC}!function(e){switch(N=e,c){case"src":I.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructSrcProtocol(AG_LIVESRCMOONSERVER.ht,e,M)));break;case"vdn":I.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.I,ACTION_GROUP_ID.u,StarRtc.AUtils.constructVdnProtocol(AG_LIVEVDNMOONSERVER.Bt,e,M)));break;case"voip":"call"==i?I.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.o,ACTION_GROUP_ID.T,StarRtc.AUtils.constructVOIPProtocol(AG_VOIPMOONSERVER.mR,e,M))):"response"==i&&I.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.o,ACTION_GROUP_ID.T,StarRtc.AUtils.constructVOIPProtocol(AG_VOIPMOONSERVER.wR,e,M)))}}(e)}break;case"applyAnswer":e.status}},G=function(e,R){var O={type:"streamCreated",streamObj:R};O.userData=r,O.obj=s,"success"==e?O.status="success":(O.status="failed",O.error=R),S(O,"onWebrtcMessage",i)},l=function(e,R){switch(e.userData=r,e.obj=s,R){case"connect success":var O=null;switch(c){case"src":O=StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructHeartBeatMsg(AG_LIVESRCMOONSERVER.XO));break;case"vdn":O=StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.I,ACTION_GROUP_ID.u,StarRtc.AUtils.constructHeartBeatMsg(AG_LIVEVDNMOONSERVER.Qt))}I.startHeartBeat(O),u.setServerInfo({serverIp:u.needIP()?A.webrtcIP:A.ip,serverPort:A.webrtcPort}),S(e,R,i);break;case"connect failed":case"connect closed":u.destroy(),I=null,S(e,R,i);break;case"onmessage":StarRtc.AUtils.parseProtocol(e,function(e){e.appid==APP_PRODUCT_ID.i?StarRtc.AUtils.parseSrcMoonServerMessage(e.msgArr,function(e){l(e,"onWebrtcMessage")}):e.appid==APP_PRODUCT_ID.I?StarRtc.AUtils.parseVdnMoonServerMessage(e.msgArr,function(e){l(e,"onWebrtcMessage")}):e.appid==APP_PRODUCT_ID.o&&StarRtc.AUtils.parseVoipMoonServerMessage(e.msgArr,function(e){l(e,"onWebrtcMessage")})});break;case"onWebrtcMessage":switch(e.type){case"uperStreamInfoUpdate":if("success"==e.status){if(T)for(var t=0;t<7;++t){var a=u.getStreamByIndex(t),_=void 0;0!=Object.keys(C.uperInfos).length&&(_=C.uperInfos[t]);var E=e.msg.uperInfos[t];null==_&&null!=E?"vdn"!=c&&E.userId==M.starUid||S({type:"addUploader",upId:E.upId,upUserId:E.userId,streamInfo:a,room:s},R,i):null!=_&&null==E?S({type:"removeUploader",upId:_.upId,upUserId:_.userId,streamInfo:a,room:s},R,i):null!=_&&null!=E&&_.userId!=E.userId&&S({type:"changeUploader",upId:E.upId,oldUpUserId:_.userId,newUpUserId:E.userId,streamInfo:a,room:s},R,i)}C=e.msg}break;case"webrtcConnect":if("success"==e.status)switch(c){case"vdn":I.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.I,ACTION_GROUP_ID.u,StarRtc.AUtils.constructVdnProtocol(AG_LIVEVDNMOONSERVER.qt,{channelId:r.roomInfo.id},M)));break;case"src":I.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructSrcProtocol(AG_LIVESRCMOONSERVER.xO,N,M)))}break;case"webrtcReg":if("success"==e.status)switch(c){case"vdn":case"src":o=e.fingerprint,u.emit("_webrtc_apply_ok",o,function(){T=!0},102,111)}else console.log("webrtcReg failed");break;case"vdnApplyDownload":"success"==e.status?l({type:"uperStreamInfoUpdate",status:"success",msg:e.uperInfos},"onWebrtcMessage"):console.log("收到vdnApplyDownload failed"),S(e,R,i);break;case"srcApplyUpload":if("success"==e.status){e.tmpData=N,console.log("收到_webrtc_apply_ok");var n=clone(C);C.uperInfos={},l({type:"uperStreamInfoUpdate",status:"success",msg:n},"onWebrtcMessage")}else console.log("收到srcApplyUpload failed");S(e,R,i);break;case"streamConfig":e.status,S(e,R,i);break;case"createChannel":"success"==e.status&&(r.roomInfo.id=e.channelId,r.roomInfo.creator=M.userId),S(e,R,i);break;case"delChannel":"success"==e.status&&(r.roomInfo.id=""),S(e,R,i);break;case"serverErr":break;case"voipResponseing":case"voipCalling":"success"==e.status&&(console.log("收到_webrtc_apply_ok"),u.emit("_webrtc_apply_ok",e.fingerprint,function(){l({type:"voipStreamReady",status:"success"},"onWebrtcMessage")},102,111)),S(e,R,i);break;case"voipStreamReady":a=u.getStreamByIndex(0);u.switchStreamInfo(a),S({type:"voipStreamReady",streamObj:a.streamObj,room:s},R,i);break;case"streamInactive":s.leaveRoom(),s.sigDisconnect();break;default:S(e,R,i)}}};return s.sigConnect=function(){switch(P=!1,I=null,c){case"src":if(!n.configModePulic){I=new StarRtc.WebrtcWebsocket(l,null),(R={}).ip=n.srcServerUrl,A.ip=R.ip,A.websocketPort=n.srcServerWebsocketPort,A.webrtcPort=n.srcServerWebrtcPort,A.webrtcIP=n.srcServerWebrtcIP,R.websocketPort=A.websocketPort;var e="wss://"+R.ip+":"+R.websocketPort;return void I.connect(e)}break;case"vdn":if(!n.configModePulic){I=new StarRtc.WebrtcWebsocket(l,null),(R={}).ip=n.vdnServerUrl,A.ip=R.ip,A.websocketPort=n.vdnServerWebsocketPort,A.webrtcPort=n.vdnServerWebrtcPort,A.webrtcIP=n.vdnServerWebrtcIP,R.websocketPort=A.websocketPort;e="wss://"+R.ip+":"+R.websocketPort;return void I.connect(e)}break;case"voip":var R;I=new StarRtc.WebrtcWebsocket(l,null),(R={}).ip=n.voipServerUrl,A.ip=R.ip,A.websocketPort=n.voipServerWebsocketPort,A.webrtcPort=n.voipServerWebrtcPort,A.webrtcIP=n.voipServerWebrtcIP,R.websocketPort=A.websocketPort;e="wss://"+R.ip+":"+R.websocketPort;return void I.connect(e);default:return}},s.sigDisconnect=function(e){null==e&&(e=!0),P=e,null!=I&&(I.close(),I=null)},s.createNew=function(){if(null!=I)switch(c){case"src":var e=AG_LIVESRCMOONSERVER.kO;I.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructSrcProtocol(e,{conCurrentNum:7,roomId:r.roomInfo.chatroomId||"",extra:r.roomInfo.name,liveType:V},M)))}},s.createNewSuperRoom=function(){if(null!=I)switch(c){case"src":I.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructSrcProtocol(AG_LIVESRCMOONSERVER.Ft,{conCurrentNum:7,roomId:r.roomInfo.chatroomId||"",extra:r.roomInfo.name,liveType:V},M)))}},s.deleteCurrRoom=function(){if(null!=I)switch(c){case"src":I.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructSrcProtocol(AG_LIVESRCMOONSERVER.qO,{channelId:r.roomInfo.id},M)))}},s.createStream=function(e){null==e&&(e={video:{width:{ideal:640},height:{ideal:480},frameRate:{ideal:25},facingMode:{ideal:["user"]}},audio:{deviceId:{ideal:["default"]}}}),"vdn"==c&&(e={video:!1,audio:!1}),"voip"==c&&r.roomInfo.audioOnly&&(e.video=!1),u.createStream(e,G,function(){l({type:"streamInactive"},"onWebrtcMessage")})},s.createScreenCaptureStream=function(e){null==e&&(e={audio:{deviceId:{ideal:["default"]}}}),u.createScreenCaptureStream(e,G,function(){l({type:"streamInactive"},"onWebrtcMessage")})},s.joinRoom=function(){u.emit("ready",L,"voip"==c)},s.leaveRoom=function(e){if(null!=I&&1==I.readyState())switch(c){case"src":I.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructSrcProtocol(AG_LIVESRCMOONSERVER.BO,{channelId:r.roomInfo.id},M)));break;case"vdn":I.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.I,ACTION_GROUP_ID.u,StarRtc.AUtils.constructVdnProtocol(AG_LIVEVDNMOONSERVER.Jt,{},M)));case"voip":I.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.o,ACTION_GROUP_ID.T,StarRtc.AUtils.constructVOIPProtocol(AG_VOIPMOONSERVER.xR,{isActive:e?0:1},M)))}},s.streamConfigChange=function(e){},s.streamConfigApply=function(e){switch(c){case"src":I.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructSrcProtocol(AG_LIVESRCMOONSERVER.JO,{streamConfig:e},M)));break;case"vdn":I.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.I,ACTION_GROUP_ID.u,StarRtc.AUtils.constructVdnProtocol(AG_LIVEVDNMOONSERVER.Xt,{streamConfig:e},M)))}},s.getState=function(){return null!=I?I.readyState():-1},s.getType=function(){return c},s.sendStreamData=function(e){switch(c){case"src":I.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructSrcProtocol(AG_LIVESRCMOONSERVER.jO,{streamData:e,streamDataType:8},M)))}},s.activeDisconnect=function(){return P},s},StarRtc.StarChatRoomSDK=function(e,R,O,t,a,_){var E=this,n=O,s=R,r=e,c=(t||CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_CHATROOM,a||new StarRtc.StarUserInfo),S=_||new StarRtc.StarConfig,i=new StarRtc.StarChatSDK(e,function(e,R){switch(e.userData=n,e.obj=E,R){case"onChatRoomMessage":e.type,s(e,R,r);break;default:s(e,R,r)}},n,t,c,S);return E.sigConnect=function(){i.sigConnect()},E.sigDisconnect=function(e){i.sigDisconnect(e)},E.createNew=function(){i.createNew()},E.sendChatMsg=function(e){i.sendChatMsg(e)},E.sendChatPrivateMsg=function(e,R){i.sendChatPrivateMsg(e,R)},E.sendChatCtrlPrivateMsg=function(e,R,O){i.sendChatCtrlPrivateMsg(e,R,O)},E.kickOutUser=function(e){i.kickOutUser(e)},E.banToSendMsg=function(e,R){i.banToSendMsg(e,R)},E.getRoomOnlineNum=function(){i.getRoomOnlineNum()},E.deleteCurrRoom=function(){i.deleteCurrRoom()},E.joinRoom=function(){i.joinRoom()},E.leaveRoom=function(){i.leaveRoom()},E.getState=function(){return i.getState()},E.activeDisconnect=function(){return i.activeDisconnect()},E},StarRtc.StarChatSDK=function(e,R,O,t,a,_){var E=this,n={},s=O,r=R,c=e,S=null,i=0,I=t||CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_CHATROOM,o=a||new StarRtc.StarUserInfo,A=_||new StarRtc.StarConfig,N=!1,M=function(e,R){switch(e.userData=s,e.obj=E,R){case"connect success":var O;O=StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.O,ACTION_GROUP_ID.V,StarRtc.AUtils.constructHeartBeatMsg(AG_CHATROOMMOONSERVER.Be)),S.startHeartBeat(O),r(e,R,c);break;case"connect failed":case"connect closed":S=null,r(e,R,c);break;case"onmessage":StarRtc.AUtils.parseProtocol(e,function(e){e.appid==APP_PRODUCT_ID.O&&StarRtc.AUtils.parseChatMoonServerMessage(e.msgArr,function(e){M(e,"onChatRoomMessage")})});break;case"onChatRoomMessage":switch(e.type){case"createChatRoom":"success"==e.status&&(s.roomInfo.id=e.chatroomId,s.roomInfo.creator=o.userId);break;case"deleteChatRoom":case"joinChatRoom":e.status;break;case"recvChatPrivateMsg":case"recvChatMsg":if(""==e.fromUserId||""==e.msg)return;if(e.msg=JSON.parse(e.msg),e.msg.fromId==o.userId)return}r(e,R,c)}};return E.sigConnect=function(){if(N=!1,A.configModePulic);else{S=new StarRtc.WebrtcWebsocket(M,null),n.ip=A.chatRoomServerUrl,n.port=A.chatRoomServerWebsocketPort;var e="wss://"+n.ip+":"+n.port;S.connect(e)}},E.sigDisconnect=function(e){null==e&&(e=!0),N=e,null!=S&&(S.close(),S=null)},E.createNew=function(){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.O,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.Ye,{roomType:0==s.roomInfo.Type?1:2,conCurrentNum:100,userDefineData:s.roomInfo.name,liveType:I},o)))},E.sendChatMsg=function(e){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.O,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.je,{roomId:s.roomInfo.id,digest:"新消息",msgIndex:++i,msg:e},o)))},E.sendChatPrivateMsg=function(e,R){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.O,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.Xe,{toUserId:e,roomId:s.roomInfo.id,digest:"新消息",msgIndex:++i,msg:R,type:"1",code:"0"},o)))},E.sendChatCtrlPrivateMsg=function(e,R,O){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.O,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.Xe,{toUserId:e,roomId:s.roomInfo.id,digest:"新消息",msgIndex:++i,msg:R,type:"0",code:O},o)))},E.kickOutUser=function(e){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.O,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.We,{kickOutUserId:e},o)))},E.banToSendMsg=function(e,R){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.O,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.Ke,{banUserId:e,banTime:R},o)))},E.getRoomOnlineNum=function(){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.O,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.ze,{roomId:s.roomInfo.id},o)))},E.deleteCurrRoom=function(){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.O,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.Fe,{},o)))},E.joinRoom=function(){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.O,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.qe,{roomId:s.roomInfo.id},o)))},E.leaveRoom=function(){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.O,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.Qe,{},o)))},E.getState=function(){return null!=S?S.readyState():-1},E.activeDisconnect=function(){return N},E};